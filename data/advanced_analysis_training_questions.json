[
  {
    "id": 1,
    "question": "Calculate reach and frequency by campaign",
    "category": "reach_frequency",
    "analysis_type": "performance_analysis",
    "scenario": "campaign_health_check",
    "difficulty": "medium",
    "expected_sql": "SELECT Campaign_Name, SUM(Reach) as total_reach, (SUM(Impressions) * 1.0 / SUM(Reach)) as avg_frequency FROM campaigns GROUP BY Campaign_Name ORDER BY avg_frequency DESC"
  },
  {
    "id": 2,
    "question": "Show campaigns with frequency above 5 indicating potential ad fatigue",
    "category": "reach_frequency",
    "analysis_type": "performance_analysis",
    "scenario": "ad_fatigue_detection",
    "difficulty": "medium",
    "expected_sql": "SELECT Campaign_Name, (SUM(Impressions) * 1.0 / SUM(Reach)) as frequency FROM campaigns GROUP BY Campaign_Name HAVING (SUM(Impressions) * 1.0 / SUM(Reach)) > 5"
  },
  {
    "id": 3,
    "question": "Analyze conversion funnel from impressions to conversions",
    "category": "conversion_funnel",
    "analysis_type": "performance_analysis",
    "scenario": "funnel_optimization",
    "difficulty": "hard",
    "expected_sql": "SELECT Campaign_Name, SUM(Impressions) as impressions, SUM(Clicks) as clicks, SUM(Conversions) as conversions, (SUM(Clicks) * 100.0 / SUM(Impressions)) as ctr, (SUM(Conversions) * 100.0 / SUM(Clicks)) as conv_rate, (SUM(Conversions) * 100.0 / SUM(Impressions)) as overall_conv_rate FROM campaigns GROUP BY Campaign_Name"
  },
  {
    "id": 4,
    "question": "Compare actual CPA vs target CPA of $50 to identify underperforming campaigns",
    "category": "cost_efficiency",
    "analysis_type": "performance_analysis",
    "scenario": "budget_optimization",
    "difficulty": "medium",
    "expected_sql": "SELECT Campaign_Name, (SUM(Spend) / SUM(Conversions)) as actual_cpa, 50 as target_cpa, ((SUM(Spend) / SUM(Conversions)) - 50) as variance FROM campaigns GROUP BY Campaign_Name HAVING (SUM(Spend) / SUM(Conversions)) > 50"
  },
  {
    "id": 5,
    "question": "Calculate 7-day rolling average ROAS to identify trends",
    "category": "trend_analysis",
    "analysis_type": "temporal_analysis",
    "scenario": "performance_monitoring",
    "difficulty": "hard",
    "expected_sql": "SELECT Date, (SUM(Revenue) / SUM(Spend)) as daily_roas, AVG((SUM(Revenue) / SUM(Spend))) OVER (ORDER BY Date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as rolling_7day_roas FROM campaigns GROUP BY Date ORDER BY Date"
  },
  {
    "id": 6,
    "question": "Identify best performing hour of day for conversions",
    "category": "dayparting",
    "analysis_type": "temporal_analysis",
    "scenario": "ad_scheduling_optimization",
    "difficulty": "hard",
    "expected_sql": "SELECT EXTRACT(HOUR FROM CAST(Date AS TIMESTAMP)) as hour_of_day, SUM(Conversions) as total_conversions, (SUM(Conversions) * 100.0 / SUM(Clicks)) as conv_rate FROM campaigns GROUP BY hour_of_day ORDER BY conv_rate DESC"
  },
  {
    "id": 7,
    "question": "Analyze budget pacing - percent spent vs percent of time elapsed",
    "category": "pacing_analysis",
    "analysis_type": "temporal_analysis",
    "scenario": "budget_management",
    "difficulty": "hard",
    "expected_sql": "SELECT Campaign_Name, SUM(Spend) as spent_to_date, 100000 as total_budget, (SUM(Spend) * 100.0 / 100000) as pct_spent FROM campaigns GROUP BY Campaign_Name"
  },
  {
    "id": 8,
    "question": "Compare performance across age and gender segments to find best audience",
    "category": "demographic_performance",
    "analysis_type": "audience_analysis",
    "scenario": "audience_optimization",
    "difficulty": "medium",
    "expected_sql": "SELECT Age, Gender, SUM(Impressions) as impressions, (SUM(Clicks) * 100.0 / SUM(Impressions)) as ctr, (SUM(Revenue) / SUM(Spend)) as roas FROM campaigns GROUP BY Age, Gender ORDER BY roas DESC"
  },
  {
    "id": 9,
    "question": "Identify top 3 and bottom 3 performing geographic regions by ROAS",
    "category": "geographic_analysis",
    "analysis_type": "audience_analysis",
    "scenario": "geo_targeting_optimization",
    "difficulty": "medium",
    "expected_sql": "(SELECT Location, (SUM(Revenue) / SUM(Spend)) as roas, 'Top' as performance FROM campaigns GROUP BY Location ORDER BY roas DESC LIMIT 3) UNION ALL (SELECT Location, (SUM(Revenue) / SUM(Spend)) as roas, 'Bottom' as performance FROM campaigns GROUP BY Location ORDER BY roas LIMIT 3)"
  },
  {
    "id": 10,
    "question": "Analyze cross-device performance to identify device-specific issues",
    "category": "device_analysis",
    "analysis_type": "audience_analysis",
    "scenario": "device_optimization",
    "difficulty": "medium",
    "expected_sql": "SELECT Device, SUM(Impressions) as impressions, (SUM(Clicks) * 100.0 / SUM(Impressions)) as ctr, (SUM(Conversions) * 100.0 / SUM(Clicks)) as conv_rate, (SUM(Revenue) / SUM(Spend)) as roas FROM campaigns GROUP BY Device"
  },
  {
    "id": 11,
    "question": "Compare Creative A vs Creative B performance for A/B test",
    "category": "ab_testing",
    "analysis_type": "statistical_testing",
    "scenario": "creative_testing",
    "difficulty": "medium",
    "expected_sql": "SELECT Creative_Name, SUM(Impressions) as impressions, SUM(Clicks) as clicks, (SUM(Clicks) * 100.0 / SUM(Impressions)) as ctr, SUM(Conversions) as conversions, (SUM(Conversions) * 100.0 / SUM(Clicks)) as conv_rate FROM campaigns WHERE Creative_Name IN ('Creative_A', 'Creative_B') GROUP BY Creative_Name"
  },
  {
    "id": 12,
    "question": "Calculate campaign performance vs industry benchmark CTR of 2.5%",
    "category": "benchmark_comparison",
    "analysis_type": "comparative_analysis",
    "scenario": "performance_benchmarking",
    "difficulty": "medium",
    "expected_sql": "SELECT Campaign_Name, (SUM(Clicks) * 100.0 / SUM(Impressions)) as actual_ctr, 2.5 as benchmark_ctr, (((SUM(Clicks) * 100.0 / SUM(Impressions)) - 2.5) / 2.5 * 100) as pct_vs_benchmark FROM campaigns GROUP BY Campaign_Name"
  },
  {
    "id": 13,
    "question": "Compare channel performance to optimize budget allocation",
    "category": "channel_comparison",
    "analysis_type": "comparative_analysis",
    "scenario": "channel_mix_optimization",
    "difficulty": "medium",
    "expected_sql": "SELECT Channel, SUM(Spend) as spend, SUM(Revenue) as revenue, (SUM(Revenue) / SUM(Spend)) as roas, (SUM(Spend) / SUM(Conversions)) as cpa, SUM(Conversions) as conversions FROM campaigns GROUP BY Channel ORDER BY roas DESC"
  },
  {
    "id": 14,
    "question": "Rank creatives by performance and identify top 20% to scale",
    "category": "creative_performance",
    "analysis_type": "comparative_analysis",
    "scenario": "creative_optimization",
    "difficulty": "hard",
    "expected_sql": "SELECT Creative_Name, (SUM(Revenue) / SUM(Spend)) as roas, NTILE(5) OVER (ORDER BY (SUM(Revenue) / SUM(Spend)) DESC) as performance_quintile FROM campaigns GROUP BY Creative_Name"
  },
  {
    "id": 15,
    "question": "Calculate correlation between media spend and conversions",
    "category": "correlation_analysis",
    "analysis_type": "statistical_testing",
    "scenario": "roi_validation",
    "difficulty": "hard",
    "expected_sql": "SELECT CORR(daily_spend, daily_conversions) as spend_conversion_correlation FROM (SELECT Date, SUM(Spend) as daily_spend, SUM(Conversions) as daily_conversions FROM campaigns GROUP BY Date) daily_data"
  },
  {
    "id": 16,
    "question": "Identify campaigns with declining ROAS trend over last 7 days",
    "category": "trend_analysis",
    "analysis_type": "temporal_analysis",
    "scenario": "ad_fatigue_detection",
    "difficulty": "hard",
    "expected_sql": "WITH daily_roas AS (SELECT Campaign_Name, Date, (SUM(Revenue) / SUM(Spend)) as daily_roas FROM campaigns GROUP BY Campaign_Name, Date) SELECT Campaign_Name FROM daily_roas WHERE Date >= CURRENT_DATE - INTERVAL '7 days' GROUP BY Campaign_Name HAVING (MAX(CASE WHEN Date = CURRENT_DATE THEN daily_roas END) < MAX(CASE WHEN Date = CURRENT_DATE - INTERVAL '7 days' THEN daily_roas END))"
  },
  {
    "id": 17,
    "question": "Calculate customer acquisition cost and LTV:CAC ratio",
    "category": "customer_acquisition",
    "analysis_type": "business_impact",
    "scenario": "customer_value_analysis",
    "difficulty": "hard",
    "expected_sql": "SELECT Campaign_Name, (SUM(Spend) / COUNT(DISTINCT customer_id)) as cac, AVG(customer_lifetime_value) as avg_ltv, (AVG(customer_lifetime_value) / (SUM(Spend) / COUNT(DISTINCT customer_id))) as ltv_cac_ratio FROM customer_acquisition GROUP BY Campaign_Name"
  },
  {
    "id": 18,
    "question": "Analyze post-click vs post-view conversion attribution",
    "category": "attribution_modeling",
    "analysis_type": "statistical_testing",
    "scenario": "attribution_analysis",
    "difficulty": "medium",
    "expected_sql": "SELECT Campaign_Name, SUM(Post_Click_Conversions) as post_click, SUM(Post_View_Conversions) as post_view, (SUM(Post_Click_Conversions) * 100.0 / (SUM(Post_Click_Conversions) + SUM(Post_View_Conversions))) as pct_post_click FROM campaigns GROUP BY Campaign_Name"
  },
  {
    "id": 19,
    "question": "Identify audience segments with ROAS above 5 for scaling",
    "category": "audience_segmentation",
    "analysis_type": "audience_analysis",
    "scenario": "audience_expansion",
    "difficulty": "medium",
    "expected_sql": "SELECT Age, Gender, Device, (SUM(Revenue) / SUM(Spend)) as roas, SUM(Spend) as spend FROM campaigns GROUP BY Age, Gender, Device HAVING (SUM(Revenue) / SUM(Spend)) > 5 ORDER BY roas DESC"
  },
  {
    "id": 20,
    "question": "Calculate week-over-week performance change",
    "category": "trend_analysis",
    "analysis_type": "temporal_analysis",
    "scenario": "performance_monitoring",
    "difficulty": "hard",
    "expected_sql": "WITH weekly_data AS (SELECT DATE_TRUNC('week', CAST(Date AS DATE)) as week, SUM(Revenue) as weekly_revenue, SUM(Spend) as weekly_spend FROM campaigns GROUP BY week) SELECT week, weekly_revenue, weekly_spend, (weekly_revenue / weekly_spend) as roas, LAG(weekly_revenue / weekly_spend) OVER (ORDER BY week) as prev_week_roas, ((weekly_revenue / weekly_spend) - LAG(weekly_revenue / weekly_spend) OVER (ORDER BY week)) / LAG(weekly_revenue / weekly_spend) OVER (ORDER BY week) * 100 as wow_change_pct FROM weekly_data"
  },
  {
    "id": 21,
    "question": "Identify campaigns with high CTR but low conversion rate indicating landing page issues",
    "category": "funnel_analysis",
    "analysis_type": "performance_analysis",
    "scenario": "landing_page_optimization",
    "difficulty": "medium",
    "expected_sql": "SELECT Campaign_Name, (SUM(Clicks) * 100.0 / SUM(Impressions)) as ctr, (SUM(Conversions) * 100.0 / SUM(Clicks)) as conv_rate FROM campaigns GROUP BY Campaign_Name HAVING (SUM(Clicks) * 100.0 / SUM(Impressions)) > 2.5 AND (SUM(Conversions) * 100.0 / SUM(Clicks)) < 5"
  },
  {
    "id": 22,
    "question": "Calculate video engagement metrics - quartile completion rates",
    "category": "video_analysis",
    "analysis_type": "engagement_metrics",
    "scenario": "video_optimization",
    "difficulty": "medium",
    "expected_sql": "SELECT Campaign_Name, (SUM(Video_Quartile_1) * 100.0 / SUM(Video_Views)) as q1_rate, (SUM(Video_Quartile_2) * 100.0 / SUM(Video_Views)) as q2_rate, (SUM(Video_Quartile_3) * 100.0 / SUM(Video_Views)) as q3_rate, AVG(Video_Completion_Rate) as completion_rate FROM campaigns WHERE Video_Views > 0 GROUP BY Campaign_Name"
  },
  {
    "id": 23,
    "question": "Analyze viewability rate by placement to optimize inventory",
    "category": "viewability_analysis",
    "analysis_type": "performance_analysis",
    "scenario": "inventory_optimization",
    "difficulty": "medium",
    "expected_sql": "SELECT Placement, (SUM(Viewable_Impressions) * 100.0 / SUM(Measurable_Impressions)) as viewability_rate, SUM(Impressions) as total_impressions FROM campaigns GROUP BY Placement ORDER BY viewability_rate DESC"
  },
  {
    "id": 24,
    "question": "Compare weekend vs weekday performance",
    "category": "dayparting",
    "analysis_type": "temporal_analysis",
    "scenario": "scheduling_optimization",
    "difficulty": "medium",
    "expected_sql": "SELECT CASE WHEN EXTRACT(DOW FROM CAST(Date AS DATE)) IN (0, 6) THEN 'Weekend' ELSE 'Weekday' END as day_type, SUM(Impressions) as impressions, (SUM(Clicks) * 100.0 / SUM(Impressions)) as ctr, (SUM(Revenue) / SUM(Spend)) as roas FROM campaigns GROUP BY day_type"
  },
  {
    "id": 25,
    "question": "Identify campaigns with increasing CPA trend indicating optimization needed",
    "category": "trend_analysis",
    "analysis_type": "temporal_analysis",
    "scenario": "cost_control",
    "difficulty": "hard",
    "expected_sql": "WITH daily_cpa AS (SELECT Campaign_Name, Date, (SUM(Spend) / SUM(Conversions)) as daily_cpa FROM campaigns GROUP BY Campaign_Name, Date) SELECT Campaign_Name, AVG(daily_cpa) as avg_cpa, REGR_SLOPE(daily_cpa, EXTRACT(EPOCH FROM Date)) as cpa_trend FROM daily_cpa GROUP BY Campaign_Name HAVING REGR_SLOPE(daily_cpa, EXTRACT(EPOCH FROM Date)) > 0"
  },
  {
    "id": 26,
    "question": "Calculate incremental reach across multiple campaigns",
    "category": "reach_analysis",
    "analysis_type": "audience_analysis",
    "scenario": "cross_campaign_analysis",
    "difficulty": "hard",
    "expected_sql": "SELECT SUM(DISTINCT user_id) as unique_reach, SUM(impressions) as total_impressions, (SUM(impressions) * 1.0 / SUM(DISTINCT user_id)) as avg_frequency FROM campaign_user_data"
  },
  {
    "id": 27,
    "question": "Analyze first-touch vs last-touch attribution by channel",
    "category": "attribution_modeling",
    "analysis_type": "statistical_testing",
    "scenario": "channel_attribution",
    "difficulty": "hard",
    "expected_sql": "SELECT Channel, SUM(first_touch_conversions) as first_touch, SUM(last_touch_conversions) as last_touch, (SUM(first_touch_conversions) * 100.0 / (SUM(first_touch_conversions) + SUM(last_touch_conversions))) as pct_first_touch FROM attribution_data GROUP BY Channel"
  },
  {
    "id": 28,
    "question": "Calculate engagement rate and identify low engagement placements",
    "category": "engagement_metrics",
    "analysis_type": "performance_analysis",
    "scenario": "engagement_optimization",
    "difficulty": "medium",
    "expected_sql": "SELECT Placement, (SUM(Engagement) * 100.0 / SUM(Impressions)) as engagement_rate, SUM(Impressions) as impressions FROM campaigns GROUP BY Placement HAVING (SUM(Engagement) * 100.0 / SUM(Impressions)) < 1 ORDER BY engagement_rate"
  },
  {
    "id": 29,
    "question": "Identify campaigns with ROAS below 1 losing money",
    "category": "cost_efficiency",
    "analysis_type": "performance_analysis",
    "scenario": "profitability_analysis",
    "difficulty": "easy",
    "expected_sql": "SELECT Campaign_Name, (SUM(Revenue) / SUM(Spend)) as roas, SUM(Spend) as spend, SUM(Revenue) as revenue, (SUM(Revenue) - SUM(Spend)) as profit FROM campaigns GROUP BY Campaign_Name HAVING (SUM(Revenue) / SUM(Spend)) < 1 ORDER BY roas"
  },
  {
    "id": 30,
    "question": "Calculate diminishing returns point - when additional spend stops improving ROAS",
    "category": "optimization_analysis",
    "analysis_type": "statistical_testing",
    "scenario": "budget_optimization",
    "difficulty": "hard",
    "expected_sql": "WITH spend_buckets AS (SELECT NTILE(10) OVER (ORDER BY daily_spend) as spend_decile, daily_spend, daily_roas FROM (SELECT Date, SUM(Spend) as daily_spend, (SUM(Revenue) / SUM(Spend)) as daily_roas FROM campaigns GROUP BY Date) daily) SELECT spend_decile, AVG(daily_spend) as avg_spend, AVG(daily_roas) as avg_roas FROM spend_buckets GROUP BY spend_decile ORDER BY spend_decile"
  }
]
